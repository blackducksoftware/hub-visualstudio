using RestSharp;

namespace BlackDuckHub.VisualStudio.API
{
    public static class ComponentVulnerability
    {
        public static IRestResponse<Classes.ComponentVulnerability.RootObject> GetVulnerabilities(IRestResponse<Classes.ComponentVersion.RootObject> getComponentVersionResponse, string hubServerUrl, RestClient client, string vulnHref)
        {
            var getVulnerabilities =
                new RestRequest(
                    vulnHref.Replace(
                       hubServerUrl, string.Empty));
            return client.Execute<Classes.ComponentVulnerability.RootObject>(getVulnerabilities);
        }
    }
}